<html>
  <body onload="checkTokenGrant()">
    <script language="javaScript">
      var idpLogin='https://if-idp.appspot.com/oauth/authorize?client_id=test.oauth2.code.client&response_type=token&redirect_uri='+'http://'+window.location.hostname+window.location.pathname;
      function redirectToIdp(){
      	console.log("redirecting login to:" + idpLogin);
        window.location=idpLogin;
      }
      function checkTokenGrant() {
      	// First, parse the query string
		var params = {}, queryString = location.hash.substring(1),
		    regex = /([^&=]+)=([^&]*)/g, m;
		while (m = regex.exec(queryString)) {
		  params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
		}

		// Verify that we have a token grant
		if (params['access_token']) {
			alert("Login success");
			document.getElementById("main").textContent = "Welcome User";
		} else {
			document.getElementById("main").textContent = "Welcome Guest";
		}
      }
    </script>
    <div id="main"/>
    <a href="javascript:redirectToIdp();">Login</a>
</body>
</html>
