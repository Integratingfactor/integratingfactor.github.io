<html>
  <body onload="checkTokenGrant()">
    <script language="javaScript">
      var idpLogin='https://if-idp.appspot.com/oauth/authorize?client_id=test.oauth2.code.client&response_type=token&redirect_uri='+'http://'+window.location.hostname+window.location.pathname;
      Element.prototype.remove = function() {
	    this.parentElement.removeChild(this);
 	  }
	  NodeList.prototype.remove = HTMLCollection.prototype.remove = function() {
	    for(var i = this.length - 1; i >= 0; i--) {
	        if(this[i] && this[i].parentElement) {
	            this[i].parentElement.removeChild(this[i]);
	        }
	    }
	  }
      function login(){
        window.location=idpLogin;
      }
      function login(){
        window.location='http://'+window.location.hostname+window.location.pathname;
      }
      function checkTokenGrant() {
      	// First, parse the query string
		var params = {}, queryString = location.hash.substring(1),
		    regex = /([^&=]+)=([^&]*)/g, m;
		while (m = regex.exec(queryString)) {
		  params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
		}

		// Verify that we have a token grant
		if (params['access_token']) {
			alert("Login success");
			document.getElementById("main").textContent = "Welcome User";
			document.getElementById("login").remove();
		} else {
			document.getElementById("main").textContent = "Welcome Guest";
			document.getElementById("logout").remove();
		}
      }
    </script>
    <div id="main"></div>
    <div id="login"><a href="javascript:login();">Login</a></div>
    <div id="logout"><a href="javascript:logout();">Logout</a></div>
</body>
</html>
